import concurrent.futures
import requests
from random import choice
from datetime import datetime

class proxies():


    def proxies_get(self):
        pass
    def test(self, list):
        ava_proxies = []
        with concurrent.futures.ThreadPoolExecutor(max_workers=5) as executor:
            # Start the load operations and mark each future with its URL
            future_to_url = {executor.submit(test.isAlive, link, 'http'): link for link in list}
            for future in concurrent.futures.as_completed(future_to_url):
                ava_proxies.append(future.result())
        return ava_proxies

    def isAlive(self, ip, protocol):
        proxy = {protocol+':'+ip}
        try:
            req = requests.get("http://www.baidu.com",proxies=proxy, timeout=0.05)
            delay = req.elapsed.microseconds
            test_time = datetime.utcnow()
            proxy_info = [ip, protocol, delay, test_time]
        except:
            print('Failed to Connect')
        return proxy_info
if __name__=='__main__':
    ALL_PROXIES = ['114.238.114.252:808',
                   '203.156.126.55:3129',
                   '115.220.144.201:808',
                   '182.34.21.52:808',
                   '175.153.20.65:808',
                   '59.175.72.237:8998',
                   '147.255.107.8:8118',
                   '122.241.73.176:808',
                   '60.178.131.183:8081',
                   '125.106.131.0:808',
                   '218.2.89.34:808',
                   '176.237.17.173:8080',
                   '43.241.227.180:8000',
                   '59.62.164.122:808',
                   '123.55.189.108:808',
                   '218.64.92.117:808',
                   '67.158.45.129:3128',
                   '147.255.107.211:8118',
                   '111.115.70.54:8998',
                   '14.105.243.209:8998',
                   '125.106.92.58:808',
                   '176.237.188.37:8080',
                   '147.255.107.120:8118',
                   '115.203.71.145:808',
                   '187.84.138.76:8080',
                   '147.255.107.26:8118',
                   '119.5.0.33:808',
                   '139.219.194.39:8088',
                   '117.43.0.252:808',
                   '222.94.145.69:808',
                   '123.163.160.59:808',
                   '147.255.107.144:8118',
                   '114.239.145.211:808',
                   '147.255.107.227:8118',
                   '121.226.163.253:808',
                   '147.255.107.92:8118',
                   '123.169.87.159:808',
                   '109.193.51.83:3128',
                   '171.13.36.135:808',
                   '147.255.107.35:8118',
                   '125.93.149.230:9000',
                   '60.178.173.37:8081',
                   '60.178.10.101:8081',
                   '114.230.219.187:808',
                   '83.128.78.174:80',
                   '27.18.174.126:8998',
                   '111.76.226.114:808',
                   '141.196.222.159:8080',
                   '147.255.107.29:8118',
                   '115.203.66.232:808',
                   '123.55.188.142:808',
                   '175.155.241.56:808',
                   '221.229.44.169:808',
                   '147.255.107.191:8118',
                   '147.255.107.59:8118',
                   '123.169.87.151:808',
                   '147.255.107.99:8118',
                   '81.128.165.5:3128',
                   '218.64.152.14:808',
                   '115.215.68.21:808',
                   '218.2.89.43:808',
                   '91.205.131.168:8080',
                   '123.55.190.58:808',
                   '147.255.107.63:8118',
                   '182.34.26.29:808',
                   '123.55.190.103:808',
                   '147.255.107.5:8118',
                   '60.184.174.216:808',
                   '125.93.149.214:9000',
                   '218.65.67.190:808',
                   '61.19.82.138:8080',
                   '115.203.204.51:808',
                   '115.215.69.222:808',
                   '60.184.173.237:808',
                   '182.45.176.229:808',
                   '119.5.0.14:808',
                   '123.169.90.79:808',
                   '182.34.21.128:808',
                   '141.196.70.167:8080',
                   '141.196.198.63:8080',
                   '115.212.83.223:808',
                   '119.85.184.200:8998',
                   '182.34.22.135:808',
                   '115.212.58.53:808',
                   '147.255.107.222:8118',
                   '110.83.46.37:808',
                   '115.220.0.92:808',
                   '114.239.148.114:808',
                   '61.232.254.39:3128',
                   '180.110.18.161:808',
                   '62.68.246.27:8080',
                   '175.43.106.155:808',
                   '147.255.107.248:8118',
                   '125.89.123.15:808',
                   '103.17.246.228:8080',
                   '141.196.150.114:8080',
                   '62.159.193.83:80',
                   '134.35.196.109:8080',
                   '118.89.239.139:3128',
                   '175.155.244.51:808', ]
    all = [['60.167.134.141', '808'],
           ['123.163.164.119', '808'],
           ['36.249.29.139', '808'],
           ['46.38.52.36', '8081'],
           ['176.12.121.190', '8080'],
           ['46.101.86.183', '80'],
           ['113.161.68.146', '8080'],
           ['59.149.168.92', '8998'],
           ['123.169.86.178', '808'],
           ['114.230.123.162', '808'],
           ['212.200.144.70', '8080'],
           ['118.124.41.180', '808'],
           ['180.176.154.51', '3128'],
           ['117.43.0.119', '808'],
           ['178.245.246.237', '8080'],
           ['139.255.92.5', '8088'],
           ['202.123.28.21', '80'],
           ['60.178.8.136', '8081'],
           ['141.196.67.108', '8080'],
           ['36.73.67.199', '8080'],
           ['49.83.9.148', '808'],
           ['221.227.32.68', '8998'],
           ['91.98.156.3', '80'],
           ['103.40.151.90', '8080'],
           ['115.220.151.61', '808'],
           ['113.120.0.51', '808'],
           ['193.150.39.101', '8080'],
           ['114.230.125.20', '808'],
           ['200.133.37.38', '80'],
           ['113.121.160.34', '808'],
           ['188.56.143.55', '8080'],
           ['123.169.85.151', '808'],
           ['188.113.143.253', '3128'],
           ['222.124.145.198', '3128'],
           ['175.155.24.55', '808'],
           ['124.122.175.3', '8888'],
           ['182.88.46.30', '8123'],
           ['59.62.83.54', '808'],
           ['37.204.153.97', '8081'],
           ['5.196.68.118', '8118'],
           ['122.241.74.63', '808'],
           ['46.218.85.101', '3129'],
           ['139.82.28.3', '8080'],
           ['58.218.196.126', '808'],
           ['112.67.91.31', '8998'],
           ['178.33.13.183', '24631'],
           ['122.96.59.100', '843'],
           ['139.82.74.3', '8080'],
           ['121.234.76.193', '8998'],
           ['222.94.146.61', '808'],
           ['115.220.149.120', '808'],
           ['175.155.242.0', '808'],
           ['115.220.7.180', '808'],
           ['175.158.59.11', '8080'],
           ['182.88.179.50', '8123'],
           ['188.0.129.36', '3128'],
           ['45.76.219.251', '3128'],
           ['1.206.250.4', '8998'],
           ['118.181.209.14', '9000'],
           ['115.220.148.202', '808'],
           ['120.24.182.175', '8118'],
           ['175.155.243.36', '808'],
           ['61.6.67.40', '53281'],
           ['141.196.142.107', '8080'],
           ['115.220.149.143', '808'],
           ['212.227.10.92', '3128'],
           ['94.19.39.81', '3128'],
           ['222.76.118.155', '808'],
           ['122.241.72.116', '808'],
           ['37.152.177.145', '8080'],
           ['36.80.117.68', '3128'],
           ['112.124.9.156', '7777'],
           ['177.67.82.97', '8080'],
           ['218.2.89.34', '808'],
           ['175.155.24.61', '808'],
           ['191.7.192.136', '8080'],
           ['115.220.7.150', '808'],
           ['115.192.96.168', '808'],
           ['85.14.178.18', '83'],
           ['118.144.154.253', '3128'],
           ['113.58.232.224', '808'],
           ['189.50.11.198', '3128'],
           ['125.89.123.123', '808'],
           ['45.77.12.14', '1080'],
           ['218.67.126.15', '3128'],
           ['176.237.17.133', '8080'],
           ['114.239.2.200', '808'],
           ['171.80.187.157', '808'],
           ['177.190.209.10', '8080'],
           ['218.64.93.22', '808'],
           ['115.220.7.14', '808'],
           ['122.241.73.56', '808'],
           ['122.241.75.59', '808'],
           ['109.205.115.13', '8080'],
           ['36.78.60.81', '8080'],
           ['125.89.122.44', '808'],
           ['123.163.80.158', '808'],
           ['113.58.232.22', '808'],
           ['176.237.139.22', '8080'],
           ['213.211.138.45', '3128']]
    test=proxies()
    ava_proxies= test.test(ALL_PROXIES)
    print(len(ALL_PROXIES))
    print(len(ava_proxies))